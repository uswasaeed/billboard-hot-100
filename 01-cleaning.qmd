---
title: "Cleaning"
format: html
---

## Goals of this notebook

The steps we'll take to prepare our data:

- Download the data
- Import it into our notebook
- Clean up data types and columns
- Export the data for next notebook

## Setup

Loading the libraries.

```{r}
#| label: setup
#| message: false
#| warning: false

library(tidyverse)
library(janitor)
```

## Download our data

This data comes from [Professor McDonald's repo](https://github.com/utdata/rwd-billboard-data/tree/main).

```{r}
# download.file("https://github.com/utdata/rwd-billboard-data/blob/main/data-out/hot100_assignment.csv?raw=true",
#   "data-original/hot100_assignment.csv",
#   mode = "wb"
# )
```


## Import the data

Getting the data we downloaded above.

```{r}
#| label: import

hot100_raw <- read_csv("data-original/hot100_assignment.csv") |> clean_names()

hot100_raw
```

Glimpse the data.

```{r}
hot100_raw |> glimpse()
```

## Fix our dates

Using lubridate to create a new column with real dates.

```{r}
# part we will build upon
hot100_date <- hot100_raw |> 
  mutate(
    chart_date = mdy(chart_week)
  ) |> 
  arrange(chart_date, this_week)

# peek at the result
hot100_date |> glimpse()
```

## Summary statistics

Getting a summary of the Hot 100 data.

```{r}
hot100_date |> summary()
```

## Selecting columns

Dropping the text date column and renaming other columns.

```{r}
hot100_clean <- hot100_date |> 
  select(
    chart_date,
    current_rank = this_week,
    title,
    performer,
    previous_rank = last_week,
    peak_rank = peak_pos,
    wks_on_chart
  )

hot100_clean |> glimpse()
```

## Exports

Exporting our data to rds.

```{r}
#| label: export

hot100_clean |> 
  write_rds("data-processed/01-hot100.rds")
```

